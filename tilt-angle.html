<html>
  <head>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link rel="stylesheet" href="stylesheet.css">
    
  </head>
 
  <body>
    <div id="vis"></div>
    <div id="tilt-text">
      <p>The human perceptive system can accurately guess vertical, horizontal, and diagonal lines, but struggles to accurately guess angles that are not.</p>
      <p>What is the degree of this tilt?</p>
    </div>
  </body>

  <script>
    // Set up grid dimensions
    var margin = {top: 20, right: 20, bottom: 20, left: 20}
    var width = 540 - margin.right - margin.left
    var height = 540 - margin.top - margin.bottom

    // Create SVG
    var svg = d3.select("#vis")
    .append('svg')
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")

    // Dummy data (to be randomly generated on backend)
    dummyData = [ 
      {label: 'a', angle: randomAngles()}, 
      {label: 'b', angle: randomAngles()}, 
      {label: 'c', angle: randomAngles()}, 
      {label: 'd', angle: randomAngles()}, 
      {label: 'e', angle: randomAngles()},
      {label: 'f', angle: randomAngles()}, 
        // {label: 'g', angle: randomAngles()}, 
        // {label: 'h', angle: randomAngles()}, 
        // {label: 'i', angle: randomAngles()}, 
        // {label: 'j', angle: randomAngles()}  
    ] 

    // Static data to generate and position lines
    dummyLine = [ [250, 250], [250, 200]  ]
    staticPositions = [ [50, 150], [0, 0], [50, -100], [-150, -100], [-150, 50], [200, 200], [-100, -200], [150, -200], [200, 0], [-150, 200] ]

    // Create grid
    svg.append("rect")
      .attr("width", width)
      .attr("height", height)
      .attr("fill", "none")

    // x axis
    var x = d3.scaleLinear().domain([0, 50]).range([0, width])
    svg.append("g")
      .attr("transform", "translate(0, "+ height + ")")
      .call(d3.axisBottom(x).tickFormat("").tickSize(0))
      .style("stroke-width", "1.5px")
      
    // y axis
    var y = d3.scaleBand()
      .domain(dummyData.map(function(d) {return d[0]}))
      .range([0, height])
      .padding(0.2)
    svg.append("g")
      .call(d3.axisLeft(y).tickFormat("").tickSize(0))
      .style("stroke-width", "1.5px")

    counter = 0
    
    dummyData.forEach(data => {
      // Create G elt to contain line + text
      var g = svg.append("g")
        .attr("id", data.label)

      // Create line
      g.append("path")
        .datum(dummyLine)
        .attr("stroke", "black")
        .attr("stroke-width", 2)
        .attr("d", d3.line()
          .x(function(d) { return d[0] })
          .y(function(d) { return d[1] })
        )
        .attr("transform", function(d) {
          return "translate(" + staticPositions[counter][0] + " " + staticPositions[counter][1] + ") rotate(" + data.angle + " 250 250)" 
        })

      // Create label
      g.append("text")
        .data(data.label)
        .text(function (d) { return d })
        .attr("x", 260) 
        .attr("y", 260) 
        .attr("transform", function(d) {
          return "translate(" + staticPositions[counter][0] + " " + staticPositions[counter][1] + ")" 
        })

      counter++
    })
    
    // Generate random angles 0 - 360 degrees
    function randomAngles() {
      return Math.floor(Math.random() * (360 - 0 + 1))
    }
  </script>
</html>
