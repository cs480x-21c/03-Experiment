<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css" />
    <script src="https://d3js.org/d3.v4.min.js"></script>
  </head>

  <body>
    <h1>Experiment</h1>
    <div id="button">
      <!-- SO 47078563 -->
      <form onsubmit="return submitGuess()">
        <!-- Form to submit guess -->
        <p>What percent of the larger is the smaller?</p>

        <input type="text" id="box" />
        <input type="submit" value="Submit Guess" />
        <button onclick="download_csv()">Download CSV</button>
      </form>
    </div>
  </body>

  <script>
    console.log(d3); // test if d3 is loaded
	
	//magic numbers begone
	const NUM_DATAPOINTS = 6;

    var guessList = []; // The list of user guess

    // Submit guess function, add guess to list
    function submitGuess() {
      guess = document.getElementById("box").value;
      guessList.push(guess); // add guess  to list
      console.log(guessList); // console log sanity
	  document.getElementById('box').value = ''; //clear the input box
      return false; // dont reload form
    }

	// Download the CSV file
    function download_csv() {
      var csv = Array.prototype.join.call(guessList, ",\n");

      filename = "guesses.csv";

      if (!csv.match(/^data:text\/csv/i)) {
        csv = "data:text/csv;charset=utf-8," + csv;
      }
      data = encodeURI(csv);

      link = document.createElement("a");
      link.setAttribute("href", data);
      link.setAttribute("download", filename);
      link.click();
    }
	
	//generate data
  const NUM_DATAPOINTS = 6;
  
  function getRandomInt(max) {
	return Math.floor(Math.random() * Math.floor(max));
  }
  
  var datapoints = [];
  var indexes = [];
  
  for (i = 0; i < NUM_DATAPOINTS; i++){
	datapoints.push(getRandomInt(100) + 1);
  }
  
  for (i = 0; i < 2; i++) {
    indexes.push(getRandomInt(6));
  }
  
  var ratio;
  if (datapoints[indexes[0]] > datapoints[indexes[1]]){
	ratio = (datapoints[indexes[1]] / datapoints[indexes[0]]) * 100;
   } else ratio = (datapoints[indexes[0]] / datapoints[indexes[1]]) * 100;

  </script>
</html>
