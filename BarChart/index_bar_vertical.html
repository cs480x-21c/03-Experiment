<script src="https://d3js.org/d3.v6.min.js"></script>


<style>
</style>
<link rel="stylesheet" href="styles.css">

<iframe
        width="560" height="315"
        src="https://www.youtube.com/embed/_8V5o2UHG0E" frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
        allowfullscreen>

</iframe>


<body>
  <h1> Experiment </h1>

  <div>
    <svg width="1500" height="1000"></svg>
  </div>


</body>

<!--This is a example from https://www.youtube.com/watch?v=_8V5o2UHG0E&t=33209s
I modified this code and added some new things-->

<script>

  console.log(d3); // test if d3 is loaded
  const svg = d3.select('svg')
  const width = +svg.attr('width')
  const height = +svg.attr('height')


  console.log(innerWidth)

  const barChart = data =>{

    const yValue = d=> d.Value;

    const xValue = d=> d.Group;


    ///// random variable generation

    var random_group = [1, 2, 3, 4, 5, 6, 7, 8];
    // shuffle the list
    const shuffledArray = random_group.sort((a, b) => 0.5 - Math.random());
    console.log(random_group)
    // select two random number
    while( random_group.length > 2 ) {
      console.log( random_group.pop() );
    }
    console.log(random_group)

    console.log(random_group[0])
    const colorLable = d=>{
      if(parseInt(d) === random_group[0] || parseInt(d) === random_group[1]){
        return 'red'
      }
      else return 'black'
    }
    /////




    console.log(yValue)
    const margin = {top: 100, left: 100, bottom: 150, right: 300};

    // define inner width  and height
    const innerWidth = width-margin.left- margin.right;
    const innerHeight = height- margin.top- margin.bottom;

    const yScale = d3.scaleLinear()
            .domain([0, 100])// .domain([0, d3.max(data, d=>d.Value)])
            .range([innerHeight,0]);



    const xScale = d3.scaleBand()
    .domain(data.map(xValue))
    .range([0, innerWidth])
    .padding(0.2); // get some gap between bars


    ////////////////


    const g = svg.append('g')
            .attr('transform', `translate(${margin.right},${margin.top})`);



    // y axis
    const yAxis = g.append('g').call(d3.axisLeft(yScale).ticks(1, "f")) //
    // .selectAll('.domain, .tick line').remove(); // remove the domain and extra lines

    // x axis
    const xAxis = g.append('g')
            .call(d3.axisBottom(xScale))
            .attr('transform', `translate(${0},${innerHeight})`)


    // add x label
    xAxis.append('text')
            .attr('y', 100)
            .attr('x', innerWidth/2)
            .attr('fill','black')
            .text('group number')

    xAxis.selectAll('text').style('fill', d => colorLable(d));



    g.append('text')
            .attr('y', -30)
            .attr('x', 100)
            .text('Bar Chart Vertical')


    //https://vizhub.com/HaowenWeiJohn/ee1866eedb104d7aa66c0a88892e5a83?edit=files&file=index.js
    // some little tricks from this example
    g.selectAll('rect').data(data)
             .enter().append('rect')
            // .attr('transform', `translate(${0},${innerHeight})`)
            .attr('x', d=>xScale(xValue(d)))
            .attr('y', d=>yScale(yValue(d)))
            .attr('width', xScale.bandwidth())
            .attr('height', d=>innerHeight-yScale(yValue(d)))

            .style('fill', '#3ba0f7');
  };


  // tick grid line


//////////////////////////////////

  d3.csv('index.csv').then(data => {
    console.log(data)
    data.forEach(d=>{
      d.Value = +d.Value; // parse
    })

    barChart(data)
  });

  const answer = 10;


</script>
