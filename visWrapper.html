<html>
    <head>
        <link rel="stylesheet" type="text/css" href="stylesheet.css">
    </head>

    <body>
        <!-- Hold visualizations -->
        <div id="visDiv"></div>

        <!-- Input form -->
        <div id="input-submit">
            <form class="input-form">
                <label for="input-text"> Answer: </label>
                <input type="text" id="input-text">
                <input type="button" id="submit-button" value="Next"/>
            </form>
        </div>
    </body>

    <script>       
        var next = null;
        var counter = 0;
        var testCounter = 0;
        var isFinished = false;
        sessionStorage.setItem("vertical", "true")
        let userAnswers = []
        let actualAnswers = []

        if(testCounter == 0){
            switchChart();
        }

        function nextButton(){
            // Get + clear input
            let input = document.getElementById("input-text").value;
            userAnswers.push(input)
            let resetText = document.getElementById("input-text");
            resetText.value = ""

            // Decide vert vs hor barchart
            if (next = "barchart.html") {
                if (testCounter === 10) {
                    sessionStorage.setItem("vertical", "false")
                }
            }
            console.log("user answers from text field: " + userAnswers)
            switchChart()
        }

        function switchChart() {
                console.log(testCounter);
                switch (counter) {
                    case 0:
                        testCounter+=1;
                        next = "barchart.html";
                        if(testCounter == 20){
                            isFinished = true;
                            testCounter = 0;
                            counter += 1;
                        }  
                        break;
                    case 1:
                        testCounter+=1;
                        next = "tilt-angle.html";
                        if(testCounter == 20){
                            isFinished = true;
                            testCounter = 0;
                            counter += 1;
                        }  

                        break;
                    case 2:
                        testCounter+=1;
                        next = "volume.html";
                        if(testCounter == 20){
                            isFinished = true;
                            testCounter = 0;
                            counter += 1;
                        }
                        break;
                    default:
                        next = "finished.html";
                        parseData()
                        break;
                }
                document.getElementById("visDiv").innerHTML = "<object type='text/html' id='object-design' data ='" + next + "'></object>";
                isFinished = false;
                // console.log(sessionStorage.getItem("actualAnswer"))
                actualAnswers.push(sessionStorage.getItem("actualAnswer"))
                console.log("actual answers from html: " + actualAnswers)
        }

        function parseData() {
            let barchartData = [];
            let angleData = [];
            let volumeData = [];

            for (let i = 0 ; i < 60 ; i++) {
                if (i < 20) {
                    barchartData.push([actualAnswers[i], userAnswers[i]]);
                } else if (i > 20 && i < 40) {
                    angleData.push([actualAnswers[i], userAnswers[i]]);
                } else if (i > 40) {
                    volumeData.push([actualAnswers[i], userAnswers[i]]);
                }
            }
            console.log(barchartData)
            console.log(angleData)
            console.log(volumeData)

            const rows = ["ParticipantID", "TrialNum", "Vis", "TruePercent", "ReportedPercent"]
            
        }



        document.getElementById("submit-button").addEventListener("click", nextButton);
    
    </script>
</html>


